<script id="tb_settings" type="text/html">
<!-- ko if:SettingController.IsAvailable() -->
    <div class="btn-group">
      <button class="btn btn-sm btn-primary btn-white" data-bind="
        title:'Отображать настройки',
        css:{'active':SettingController.IsShow()},
        click:SettingController.Toggle" >
        <i class="fa fa-wrench" ></i>
      </button>
    </div>
<!-- /ko -->
</script>



<div class="modal fade" id="settingsDefaultModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" data-bind='with:SettingController.Settings'>
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        	<h4 class="modal-title" id="myModalLabel">Изменение параметров отчета по умолчанию</h4>
      </div>
      <div style='padding:10px;'  class="modal-body">
      		<table class='table table-striped table-bordered dataTable'>
      			<tbody>
      					<tr><th >Параметр</th><th >Предыдущее значение</th><th >Изменение</th></tr>      				
      				<!-- ko foreach: SettingController.servedParams() -->
	      				<!-- ko if:SettingController.diffParams().indexOf($data.CodeParam)!=-1 -->
	      				<tr>
	      					<td data-bind='text:$data.NameParam'></td>
	      					<td data-bind='text:$data.DefaultParamSet'></td>
	      					<td data-bind='text:SettingController.resParams()[$data.CodeParam]'></td>
	      				</tr>      				
	      				<!-- /ko -->
      				<!-- /ko -->
      			</tbody>
      		</table>
      		<label class="control-label no-padding-right" for="form-field-comment" style='margin-top: 10px;margin-bottom: 10px;'>Комментарий</label>
      		 <textarea class="autosize-t1ransition form-control" style="overflow: hidden; word-wrap: break-word; resize: horizontal; height: 152px;" data-bind='value:SaveComment'>
        	</textarea>
        	<!-- ko with:SaveError -->
        		<div class="alert alert-danger" style='margin-top: 10px;' data-bind='text:$data'></div>
        	<!-- /ko -->
      </div>    
      <div class="modal-footer">
        <button type="button" class="btn btn-sm btn-primary" data-bind="lang: 'save',click:SettingController.Update" ></button>
        <button type="button" class="btn btn-sm btn-success" data-dismiss="modal" data-bind="lang: 'close'"></button>
      </div>
    </div>
  </div>
</div>

  


<script id="settings_right_menu" type="text/html">
	<!-- ko if:MBreadCrumbs.CheckPath('docview') -->
	<!-- ko if: SettingController.IsShow() -->
		<!-- ko with:SettingController.resParams -->
		<!-- ko with:SettingController -->
			<div id="sidebar-right" class="sidebar responsive sidebar-fixed sidebar-scroll">
				<div class="col-xs-12 col-no-padding">
					
					<div class="tabbable" style='margin-top:10px'>
						<ul class="nav nav-tabs">
							<!-- ko foreach: getTabs() -->
								<li data-bind="css:{'active':$data==$parent.choosedTab()}">
									<a data-toggle="tab" data-bind="text:$parent.TabName($data),click:$parent.choosedTab" aria-expanded="true"></a>
								</li>
							<!-- /ko -->
						</ul>
						<div class="tab-content extended" id="settings-scroll" data-bind='aceScroll:{height:"auto"}'>
						<!-- ko if:$data.choosedTab()=='reports' && $data.IsShowList() -->
						<div class="tab-pane fade in active" >
							<div class="accordion-style1 panel-group">
								<div class="panel panel-default">
									<div class="panel-heading">
										<h4 class="panel-title">
											<a class="accordion-toggle" data-toggle="collapse" >
												<i class="ace-icon fa fa-angle-down bigger-110" data-icon-hide="ace-icon fa fa-angle-down" data-icon-show="ace-icon fa fa-angle-right"></i>
												<span>Список отчетов</span>
											</a>
										</h4>
									</div>
									<div class="panel-body" style='padding:0px;'>
										<ul class='nav nav-list left-list noselect' data-bind='foreach:Reports'>
											<li class='submenu-level-0 highlight' data-bind='click:$parent.LoadReport,css:{"active":CxCtrl.CodeReport()==$data.CodeReport}'>
												<a data-bind='text:NameReport'></a>
											</li>
										</ul>
									</div>
								</div>
							</div>
						</div>
						<!-- /ko -->						

							<!-- ko foreach: {data: getTabs(),as: 'tab'} -->
								<div class="tab-pane fade" data-bind="css:{'in active':$data==$parent.choosedTab()}">
									<div class="accordion-style1 panel-group">
										<div class="panel panel-default">
										<!-- ko foreach: {data: $parent.getGroupsByTab(tab),as: 'grp'} -->
											<div class="panel-heading">
												<h4 class="panel-title">
													<a class="accordion-toggle" data-toggle="collapse" data-bind="click:SettingController.choosedGrp">
														<i class="ace-icon fa fa-angle-down bigger-110" data-icon-hide="ace-icon fa fa-angle-down" data-icon-show="ace-icon fa fa-angle-right"></i>
														<span data-bind='text:$data'></span>
													</a>
												</h4>
											</div>

											<div class="panel-collapse collapse" data-bind="css:{'in':$data==SettingController.choosedGrp()}"">
												<div class="panel-body" style='padding:0px;'>
													<!-- ko with: SettingController -->
														<!-- ko foreach: {data: _.filter(SettingController.servedParams(),{NameParamGrp: grp}), as: 'param'} -->
															<!-- ko if:$data.type=="checkbox" -->
																<div class="checkbox" data-bind="css:{'changed': _.includes(SettingController.diffParams(),CodeParam)}">
																	<label>
																		<input class="ace ace-checkbox-1" type="checkbox" data-bind="checkBox: $parent.resParams()[CodeParam],event: {'change': CxCtrl.Update.bind(null,'settings')}">
																		<span class="lbl small" data-bind="text:'&nbsp;'+NameParam"></span>
																	</label>
																</div>
															<!-- /ko -->
															<!-- ko if:$data.type=="select" -->
																<div class="select" data-bind="css:{'changed': _.includes(SettingController.diffParams(),CodeParam)}">
																	<label data-bind='text:$data.NameParam'></label>
																	<div>
																		<select class="form-control" data-bind="value: $parent.resParams()[CodeParam], options: _.values($data.ParamSets), optionsText: 'SNameParamSet',optionsValue: 'CodeParamSet',event: {'change': CxCtrl.Update.bind(null,'settings')}">
																		</select>
																	</div>
																</div>
															<!-- /ko -->
														<!-- /ko -->
													<!-- /ko -->
												</div>
											</div>
										<!-- /ko -->
										</div>
									</div>
								</div>
							<!-- /ko -->
						</div>
					
					</div>
				</div>
			</div>
		<!-- /ko -->
		<!-- /ko -->
	<!-- /ko -->
	<!-- /ko -->
</script>

<script id="tb_settings_pannel" type="text/html">
	<div class="wysiwyg-toolbar btn-toolbar toolH" style='padding: 0px;' >
		<div class="btn-group" >
	        <a class="btn btn-sm btn-white btn-primary dropdown-toggle" data-toggle="dropdown" style='max-width: 160px;overflow: hidden;text-overflow: ellipsis;' data-bind='with:SettingController.ChoosedReport'>
	            <span data-bind="text:NameReport"></span>
	            <i class="fa fa-angle-down icon-on-right fa-light"></i>
	        </a>
			<ul class="dropdown-menu dropdown-light dropdown-caret">
	            <!-- ko foreach:SettingController.Reports() -->
	            <li>
	              <a data-bind="click: SettingController.SelectReport">
	                <span data-bind="text: $data.NameReport"></span>
	              </a>
	            </li>
	           <!-- /ko -->
	       </ul>           
	     </div> 
		<div class="btn-group">
	      <a class="btn btn-sm btn-success btn-white " data-bind="title:'Новый отчет',css: {'disabled': !SettingController.diffParams().length},click:SettingController.NewReport">
	        <i class="ace-icon fa fa-plus"></i>
	      </a>  
	      <!-- ko with:SettingController.ChoosedReport -->
		      <!-- ko if:CodeReport=='default' -->
		      <a class="btn btn-sm btn-warning btn-white " data-bind="title:'Сохранить настройки',css: {'disabled': !SettingController.diffParams().length},click:SettingController.StartUpdate">
		        <i class="ace-icon fa fa-floppy-o"></i>
		      </a>  
		      <!-- /ko -->
	      	  <!-- ko ifnot:CodeReport=='default' -->					      
	      	  <a class="btn btn-sm btn-info btn-white " data-bind="title:'Сохранить настройки',css: {'disabled': !SettingController.diffParams().length},click:SettingController.ReportForm">
		        <i class="ace-icon fa fa-floppy-o"></i>
		      </a>
	      	  <!-- /ko -->
	      <!-- /ko -->
	    </div>
	</div>
</script>



