<script id="model_connect_buttons" type="text/html">
    <div class="btn-group">
        <!-- ko template:'model_connect_save' -->
        <!-- /ko -->
    </div>
</script>

<script id="model_connect_save" type="text/html">
    <a class='btn btn-sm btn-primary btn-white ' data-bind="title:'Сохранить',click:MModelConnector.SaveChanges" id='modelsave'>
        <i class="ace-icon fa fa-save"></i>
    </a>
</script>

<script id="connect_editor_text" type="text/html">
    <input type="text" class='small_input' data-bind='value:$data.Value'></input>
</script>

<script id="connect_editor_combobox" type="text/html">
    <combobox-editor params="field:$data.Value,fieldname:$data.Name,refmodel:$data.TargetModel,mainmodel:$data.SourceModel">
    </combobox-editor>
</script>

<script id="connect_editor_check" type="text/html">
    <input type="checkbox" class='ace ace-checkbox-2' data-bind='checked:$data.Value'>
    <span class="lbl"></span>
    </input>
</script>

<script id="connect_editor" type="text/html">
    <!-- ko if:$data.Editor == 'text' -->
    <!-- ko template:{
        name:'connect_editor_text',
		data:{
            Value: $data.Value,
        }
    } -->
    <!-- /ko -->
    <!-- /ko -->
    <!-- ko if:$data.Editor == 'check' -->
    <!-- ko template:{
        name:'connect_editor_check',
		data:{
            Value: $data.Value,
        }
    } -->
    <!-- /ko -->
    <!-- /ko -->
    <!-- ko if:$data.Editor == 'combobox' -->
    <!-- ko template:{
        name:'connect_editor_combobox',
		data:{
            Value: $data.Value,
            Name: $data.Name,
            TargetModel: $data.TargetModel,
            SourceModel: $data.SourceModel,
        }
    } -->
    <!-- /ko -->
    <!-- /ko -->
</script>

<script id="connect_form" type="text/html">
    <div class='row'>
        <table class="table table-striped table-bordered table-hover dataTable no-footer small-paddings periodsMapTable">
            <tbody data-bind='foreach:MModelConnector.MainModels'>
                <tr data-bind='css:{active:MModelConnector.IsCurrentEditModel($data)}'>
                    <td>
                        <span class="action-buttons gray-icons">
                                <a  data-bind="title:Lang.Tr('edit'), click:MModelConnector.SetEditModel">
                                    <i class="ace-icon fa fa-pencil"></i>
                                </a>
                        </span>
                    </td>
                    <td data-bind='text:$data[MModelConnector.code_source_model()]'></td>
                    <td data-bind='text:$data[MModelConnector.name_source_model()]'></td>
                    <td>
                        <table class="table openperiods table-striped table-bordered table-hover dataTable no-footer" style='min-width: 600px;'>
                            <thead data-bind='if:MModelConnector.LinkModels()[$data[MModelConnector.code_source_model()]()]().length'>
                                <tr>
                                    <!-- ko foreach:MModelConnector.model_edit_fields -->
                                    <td data-bind="text:$data.name"></td>
                                    <!-- /ko -->
                                    <!-- ko if:MModelConnector.IsCurrentEditModel($data) -->
                                    <td></td>
                                    <!-- /ko -->
                                </tr>
                            </thead>
                            <tbody>
                                <!-- ko if:MModelConnector.IsCurrentEditModel($data) -->
                                <!-- ko foreach:MModelConnector.LinkModels()[$data[MModelConnector.code_source_model()]()] -->
                                <tr>
                                    <!-- ko foreach:MModelConnector.model_edit_fields -->
                                    <td data-bind="attr:{class:$data.class}">
                                        <!-- ko template:{
                                            name:'connect_editor',
				                            data:{
                                                Editor: $data.editor,
                                                Value: $parent[$data.field_name],
                                                Name: $data.name,
                                                SourceModel: MModelConnector.source_model(),
                                                TargetModel: $data.target_model
                                            }
			                             } -->
                                        <!-- /ko -->
                                    </td>
                                    <!-- /ko -->
                                    <td class='middle_check'>
                                        <a data-bind="click:MModelConnector.RemoveLinkModel.bind($data,$parent[MModelConnector.code_source_model()]())">
                                            <i class="fa fa-icon fa-times"></i>
                                        </a>
                                    </td>
                                </tr>
                                <!-- /ko -->
                                <tr>
                                    <td colspan=5>
                                        <a class="addLinkModel" data-bind="click:function(){MModelConnector.AddLinkModel($data[MModelConnector.code_source_model()]())}">Добавить</a>
                                    </td>
                                </tr>
                                <!-- /ko -->
                                <!-- ko ifnot:MModelConnector.IsCurrentEditModel($data) -->
                                <!-- ko foreach:MModelConnector.LinkModels()[$data[MModelConnector.code_source_model()]()] -->
                                <tr>
                                    <!-- ko foreach:MModelConnector.model_edit_fields -->
                                    <td data-bind="attr:{class:$data.class}, html:$data.wrapper($parent[$data.field_name])"></td>
                                    <!-- /ko -->
                                </tr>
                                <!-- /ko -->
                                <!-- /ko -->
                            </tbody>
                        </table>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</script>
