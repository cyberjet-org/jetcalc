<script id="jetchat" type="text/html">
	<div class="jetteam-chat" data-bind='slimscroll:{}'>
			<!-- ko with:rtc.vm -->
			<div id="post-comment" data-bind="template: 'jetchat-form-tmpl'"></div>
			<!-- /ko -->
			<div id="messages" data-bind="foreach:{
	            data: rtc.vm.comments.filter(function(c){return !c.parent}),
	            as: 'comment'
	        }">
				<div class="comment" data-bind="template: 'jetchat-comment-tmpl'"></div>
			</div>
	</div> 
</script>

<script id="jetchat_flat" type="text/html">
	<div class="jetteam-chat" data-bind='slimscroll:{}'>
			<!-- ko with:rtc.vm -->
			<div id="post-comment" data-bind="template: 'jetchat-form-tmpl'"></div>
			<!-- /ko -->
			<div id="messages" data-bind="foreach:{
	            data: rtc.vm.comments.filter(function(c){return !c.parent}),
	            as: 'comment'
	        }">
				<div class="comment" data-bind="template: 'jetchat-comment-tmpl_flat'"></div>
			</div>
	</div> 
</script>

<script id="jetchat-form-tmpl" type="text/html">
	<form >
		<div contenteditable="true" placeholder="Текст сообщения..." class="textarea" data-bind="contentEditable: myComment"></div>
		<span class="sendbtn" data-bind="click: reply, visible:myComment.length>0">Отправить</span>
	</form>
</script>

<script id="jetchat-comment-tmpl" type="text/html">
	<div class="self">
		<span class="userpic" data-bind="style:{
			'background-image': 'url('+comment.user.photo+')'
		}"></span>
		<div class="heading">
			<span class="user">
                <span data-bind="text: comment.user.name"></span>
			</span>
			<span class="info">
			<span data-bind="moment: {date:comment.created,format:'fromNow'}"></span>
			</span>
		</div>
		<div class="body" data-bind="visible: !comment.collapsedSelf">
			<span data-bind="html: comment.body"></span>
		</div>
		<div class="footing" style='line-height:15px' data-bind="visible: !comment.collapsedSelf">
			<a class="replylink" href="" data-bind="click: comment.toggleReply">Ответить</a>
			<span class="rating" data-bind="
				text:(comment.getPoints()<0?'':'+')+ comment.getPoints(),
				visible: comment.getPoints()!=0,
				css:{pos:comment.getPoints()>0,neg:comment.getPoints()<0}
			  "></span>
			<span class="voting show">
                        <i class="fa" data-bind="
                            click: comment.upVote,
                            css:{
                                'fa-thumbs-up': comment.ups.indexOf(true) > -1,
                                'fa-thumbs-o-up': comment.ups.indexOf(true) < 0
                            }"></i>
                        <i class="fa fa-thumbs-up" style="transform:rotate(180deg)" data-bind="
                            click: comment.downVote,
                            css:{
                                'fa-thumbs-up': comment.downs.indexOf(true) > -1,
                                'fa-thumbs-o-up': comment.downs.indexOf(true) < 0
                            }
                        "></i>
                    </span>
			<div class="comment-reply" data-bind="template: 'jetchat-form-tmpl', visible: !comment.collapsedReply"></div>
		</div>
	</div>
	<div class="children" data-bind="visible: !comment.collapsedSelf, foreach:{
            data: comment.getChilds(),
            as: 'comment'
        }">
		<div class="comment" data-bind="template: 'jetchat-comment-tmpl'"></div>
	</div>
</script> 

<script id="jetchat-comment-tmpl_flat" type="text/html">
	<div class="self flat">
		<div class="heading">
			<span class="user">
                <span data-bind="text: comment.user.name"></span>
			</span>
			<span class="info">
			<span data-bind="moment: {date:comment.created,format:'fromNow'}"></span>
			</span>
		</div>
		<div class="body" data-bind="visible: !comment.collapsedSelf">
			<span data-bind="html: comment.body"></span>
		</div>
	</div>
	<div class="children" data-bind="visible: !comment.collapsedSelf, foreach:{
            data: comment.getChilds(),
            as: 'comment'
        }">
		<div class="comment" data-bind="template: 'jetchat-comment-tmpl_flat'"></div>
	</div>
</script>  